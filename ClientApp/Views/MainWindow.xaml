<Window x:Class="ClientApp.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="My Cloud Drive" Height="750" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">

    <Window.Resources>
        <!-- Стилі для кнопок -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="#2196F3"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="4" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1976D2"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#BDBDBD"/>
                    <Setter Property="Cursor" Value="Arrow"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="#F44336"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#D32F2F"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SuccessButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="#4CAF50"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#388E3C"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#1976D2" Padding="15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="☁" FontSize="28" Foreground="White" Margin="0,0,10,0"/>
                    <TextBlock Text="My Cloud Drive" FontSize="22" FontWeight="Bold" 
                               Foreground="White" VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock x:Name="UserNameText" Text="User" Foreground="White" 
                               VerticalAlignment="Center" Margin="0,0,15,0" FontSize="14"/>
                    <Button Content="Logout" Click="LogoutButton_Click"
                            Background="#F44336" Foreground="White" 
                            BorderThickness="0" Padding="12,6" Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#D32F2F"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Toolbar -->
        <Border Grid.Row="1" Background="White" BorderBrush="#E0E0E0" 
                BorderThickness="0,0,0,1" Padding="15,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- File Actions -->
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Button Content="📤 Upload" Click="UploadButton_Click" 
                            Style="{StaticResource ModernButton}"/>
                    <Button Content="📥 Download" Click="DownloadButton_Click" 
                            Style="{StaticResource ModernButton}"/>
                    <Button Content="🗑 Delete" Click="DeleteButton_Click" 
                            Style="{StaticResource DangerButton}"/>
                    <Button Content="📁 New Folder" Click="NewFolderButton_Click" 
                            Style="{StaticResource SuccessButton}"/>
                    <Button Content="🔄 Refresh" Click="RefreshButton_Click" 
                            Style="{StaticResource ModernButton}"/>
                </StackPanel>

                <!-- Filter -->
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <TextBlock Text="Filter:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <ComboBox x:Name="FilterComboBox" Width="150" 
                              SelectionChanged="FilterComboBox_SelectionChanged">
                        <ComboBoxItem Content="All Files" IsSelected="True"/>
                        <ComboBoxItem Content="Python (.py)"/>
                        <ComboBoxItem Content="Images (.jpg)"/>
                        <ComboBoxItem Content="Code Files"/>
                    </ComboBox>

                    <TextBlock Text="Sort:" VerticalAlignment="Center" Margin="15,0,10,0"/>
                    <ComboBox x:Name="SortComboBox" Width="150" 
                              SelectionChanged="SortComboBox_SelectionChanged">
                        <ComboBoxItem Content="Name (A-Z)" IsSelected="True"/>
                        <ComboBoxItem Content="Name (Z-A)"/>
                        <ComboBoxItem Content="Date (Newest)"/>
                        <ComboBoxItem Content="Date (Oldest)"/>
                        <ComboBoxItem Content="Uploader (A-Z)"/>
                        <ComboBoxItem Content="Uploader (Z-A)"/>
                    </ComboBox>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="2" Margin="15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*" MinWidth="300"/>
            </Grid.ColumnDefinitions>

            <!-- Files List -->
            <Border Grid.Column="0" Background="White" CornerRadius="5" 
                    BorderBrush="#E0E0E0" BorderThickness="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Column Visibility Controls -->
                    <Border Grid.Row="0" Background="#F5F5F5" Padding="10" 
                            BorderBrush="#E0E0E0" BorderThickness="0,0,0,1">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Show Columns:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <CheckBox x:Name="ShowCreatedDateCheckBox" Content="Created" IsChecked="True" 
                                      Margin="5" Checked="ColumnVisibility_Changed" Unchecked="ColumnVisibility_Changed"/>
                            <CheckBox x:Name="ShowUpdatedDateCheckBox" Content="Updated" IsChecked="True" 
                                      Margin="5" Checked="ColumnVisibility_Changed" Unchecked="ColumnVisibility_Changed"/>
                            <CheckBox x:Name="ShowUploaderCheckBox" Content="Uploader" IsChecked="True" 
                                      Margin="5" Checked="ColumnVisibility_Changed" Unchecked="ColumnVisibility_Changed"/>
                            <CheckBox x:Name="ShowEditorCheckBox" Content="Editor" IsChecked="True" 
                                      Margin="5" Checked="ColumnVisibility_Changed" Unchecked="ColumnVisibility_Changed"/>
                            <CheckBox x:Name="ShowSizeCheckBox" Content="Size" IsChecked="True" 
                                      Margin="5" Checked="ColumnVisibility_Changed" Unchecked="ColumnVisibility_Changed"/>
                        </StackPanel>
                    </Border>

                    <!-- DataGrid -->
                    <DataGrid x:Name="FilesDataGrid" Grid.Row="1" 
                              AutoGenerateColumns="False" 
                              IsReadOnly="True"
                              SelectionMode="Extended"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column"
                              RowHeight="35"
                              SelectionChanged="FilesDataGrid_SelectionChanged"
                              MouseDoubleClick="FilesDataGrid_MouseDoubleClick">

                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="📄 Name" Width="2*" CanUserResize="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding FileType}" 
                                                       FontWeight="Bold" 
                                                       Margin="0,0,5,0"
                                                       Foreground="#1976D2"/>
                                            <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTextColumn Header="Size" 
                                                Binding="{Binding SizeFormatted}" 
                                                Width="100"
                                                x:Name="SizeColumn"/>

                            <DataGridTextColumn Header="Created" 
                                                Binding="{Binding CreatedAt, StringFormat='yyyy-MM-dd HH:mm'}" 
                                                Width="150"
                                                x:Name="CreatedColumn"/>

                            <DataGridTextColumn Header="Updated" 
                                                Binding="{Binding UpdatedAt, StringFormat='yyyy-MM-dd HH:mm'}" 
                                                Width="150"
                                                x:Name="UpdatedColumn"/>

                            <DataGridTextColumn Header="Uploaded By" 
                                                Binding="{Binding UploadedByName}" 
                                                Width="150"
                                                x:Name="UploaderColumn"/>

                            <DataGridTextColumn Header="Edited By" 
                                                Binding="{Binding EditedByName}" 
                                                Width="150"
                                                x:Name="EditorColumn"/>
                        </DataGrid.Columns>

                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#E3F2FD"/>
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="#BBDEFB"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                    </DataGrid>
                </Grid>
            </Border>

            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" 
                          Background="#E0E0E0"/>

            <!-- Preview Panel -->
            <Border Grid.Column="2" Background="White" CornerRadius="5" 
                    BorderBrush="#E0E0E0" BorderThickness="1" Padding="15">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Preview" FontSize="16" 
                               FontWeight="Bold" Margin="0,0,0,10"/>

                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel x:Name="PreviewPanel">
                            <TextBlock x:Name="NoPreviewText" 
                                       Text="Select a file to preview" 
                                       TextWrapping="Wrap"
                                       Foreground="#757575"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Margin="0,50,0,0"/>

                            <!-- Image Preview -->
                            <Image x:Name="ImagePreview" 
                                   Visibility="Collapsed" 
                                   Stretch="Uniform"
                                   MaxHeight="400"/>

                            <!-- Code Preview -->
                            <Border x:Name="CodePreviewBorder" 
                                    Visibility="Collapsed"
                                    Background="#F5F5F5" 
                                    BorderBrush="#E0E0E0" 
                                    BorderThickness="1"
                                    CornerRadius="5"
                                    Padding="10">
                                <TextBox x:Name="CodePreview" 
                                         IsReadOnly="True"
                                         TextWrapping="Wrap"
                                         Background="Transparent"
                                         BorderThickness="0"
                                         FontFamily="Consolas"
                                         FontSize="12"
                                         VerticalScrollBarVisibility="Auto"
                                         MaxHeight="500"/>
                            </Border>

                            <!-- File Info -->
                            <StackPanel x:Name="FileInfoPanel" Visibility="Collapsed" Margin="0,10,0,0">
                                <TextBlock Text="File Information" FontWeight="Bold" Margin="0,0,0,10"/>
                                <TextBlock x:Name="FileNameInfo" TextWrapping="Wrap" Margin="0,2"/>
                                <TextBlock x:Name="FileSizeInfo" Margin="0,2"/>
                                <TextBlock x:Name="FileTypeInfo" Margin="0,2"/>
                                <TextBlock x:Name="FileCreatedInfo" Margin="0,2"/>
                                <TextBlock x:Name="FileUpdatedInfo" Margin="0,2"/>
                                <TextBlock x:Name="FileUploaderInfo" Margin="0,2"/>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>

        <!-- Sync Panel -->
        <Border Grid.Row="3" Background="White" BorderBrush="#E0E0E0" 
                BorderThickness="0,1,0,0" Padding="15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="🔄 Sync:" VerticalAlignment="Center" 
                               FontWeight="Bold" Margin="0,0,10,0"/>
                    <Button Content="Select Folder" Click="SelectSyncFolder_Click" 
                            Style="{StaticResource ModernButton}"/>
                    <TextBlock x:Name="SyncFolderText" Text="No folder selected" 
                               VerticalAlignment="Center" Margin="10,0"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <CheckBox x:Name="AutoSyncCheckBox" Content="Auto-sync" 
                              VerticalAlignment="Center" Margin="0,0,15,0"
                              Checked="AutoSync_Changed" Unchecked="AutoSync_Changed"/>
                    <Button Content="⬆ Upload All" Click="SyncUpload_Click" 
                            Style="{StaticResource ModernButton}"/>
                    <Button Content="⬇ Download All" Click="SyncDownload_Click" 
                            Style="{StaticResource ModernButton}"/>
                    <Button Content="⬍⬌ Sync Both" Click="SyncBoth_Click" 
                            Style="{StaticResource SuccessButton}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Status Bar -->
        <Border Grid.Row="4" Background="#F5F5F5" Padding="10,5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="StatusText" Text="Ready" 
                           VerticalAlignment="Center" Foreground="#757575"/>
                <TextBlock x:Name="FileCountText" Grid.Column="1" Text="0 files" 
                           VerticalAlignment="Center" Foreground="#757575"/>
            </Grid>
        </Border>
    </Grid>
</Window>